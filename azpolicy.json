{
  "mode": "All",
  "parameters": {
    "effect": {
      "type": "String",
      "metadata": {
        "displayName": "Effect",
        "description": "The effect of the policy (Deny or Audit)"
      },
      "allowedValues": [
        "Deny",
        "Audit",
        "Disabled"
      ],
      "defaultValue": "Deny"
    }
  },
  "policyRule": {
    "if":  {
      "field": "type",
      "notIn":  [
        "Microsoft.Resources/resourceGroups",
        "Microsoft.ContainerRegistry/registries",
        "Microsoft.App/managedEnvironments",
        "Microsoft.App/containerApps",
        "Microsoft.OperationalInsights/workspaces",
        "Microsoft.CognitiveServices/accounts",
        "Microsoft. Search/searchServices",
        "Microsoft.Storage/storageAccounts",
        "Microsoft.KeyVault/vaults",
        "Microsoft.Authorization/roleAssignments",
        "Microsoft.Insights/diagnosticSettings",
        "Microsoft.Network/privateEndpoints",
        "Microsoft.Network/privateDnsZones"
      ]
    },
    "then":  {
      "effect": "[parameters('effect')]"
    }
  }
}
